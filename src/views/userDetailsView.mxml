<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" title="userDetailsView" actionBarVisible="false" preinitialize="preinit()" creationComplete="init()">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import com.gamedonia.sdk.Credentials;
			import com.gamedonia.sdk.GDOptions;
			import com.gamedonia.sdk.GDUser;
			import com.gamedonia.sdk.GDUserProfile;
			import com.gamedonia.sdk.Gamedonia;
			import com.gamedonia.sdk.GamedoniaUsers;
			
			import components.popUpComponent;
			
			public var popup:popUpComponent = new popUpComponent();
			
			protected function preinit():void {
				
				GamedoniaUsers.getMe(function (success:Boolean, me:GDUserProfile):void {
					
					if (success) {
						
						nick_label.text = me.profile.nickname;
						date_label.text = me.profile.date;
						
					} else {
						
						trace( "Failed to get the logged in user profile." );
					}
				});
				
			}
			
			protected function init():void {
				
				// Set up constraints
				var left_constraint:Number = this.parent.width - this.parent.width*0.78;
				
				
				
				details_label.setConstraintValue("left", left_constraint);
				nick_1_label.setConstraintValue("left", left_constraint);
				date_1_label.setConstraintValue("left", left_constraint);
				
				logout_button.setConstraintValue("left", left_constraint);
				
			}
			
			protected function logout_clickHandler( event:MouseEvent ):void {
				
				GamedoniaUsers.logoutUser( function ( success:Boolean ):void {
					
					if ( success ) {
						
						navigator.popToFirstView();
						
					} else {
						
						trace( "Failed to log out." );
					}
				});
				
			}
		]]>
	</fx:Script>
	<s:BitmapImage source="@Embed('../assets/background@2x.png')" 
				   left="0" right="0"  
				   width="100%" height="100%" 
				   />
	<s:Label id="details_label" y="87" left="70" fontFamily="Arial" fontSize="15" text="Account Details:"/>
	<s:Label id="nick_1_label" y="141" left="70" fontFamily="Arial" fontSize="15" text="Nickname:"/>
	<s:Label id="date_1_label" y="164" left="70" fontFamily="Arial" fontSize="15" text="Regis. Date:"/>
	<s:Label id="nick_label" y="141" right="10" fontFamily="Arial" fontSize="15" text=""/>
	<s:Label id="date_label" y="164" right="10" fontFamily="Arial" fontSize="15" text=""/>
	<s:Button id="logout_button" y="229" left="70" right="10" label="Logout" chromeColor="#6eac2b"
			  click="logout_clickHandler(event)" color="#FFFFFF" fontFamily="Arial" fontSize="15" textShadowAlpha="0"/>
</s:View>
